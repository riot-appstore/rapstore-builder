[tox]
envlist = py35-{pylint,flake8,tests,checksetup}

[testenv]
setenv =
    TMPDIR = {envtmpdir}
deps =
    -rtests_utils/test-requirements.txt
commands =
    {[testenv:_tmpdir]commands}
    pylint:       {[testenv:pylint]commands}
    flake8:       {[testenv:flake8]commands}
    tests:        {[testenv:tests]commands}
    checksetup:   {[testenv:checksetup]commands}

[testenv:tests]
commands =
    pytest --verbose

# On some tox versions, {envtmpdir} is not created by default
[testenv:_tmpdir]
commands =
    {envpython} -c 'import os; os.makedirs("{envtmpdir}", exist_ok=True)'

[testenv:pylint]
commands =
    pylint --rcfile={toxinidir}/setup.cfg {envsitepackagesdir}/rapstorebuilder

[testenv:flake8]
commands =
    flake8

[testenv:checksetup]
commands =
    {envpython} setup.py check --strict --metadata

[testenv:devenv]
basepython = python3
envdir = devenv
usedevelop = True
commands =
    {envpython} -c "print('\n'\
        '    Run  source devenv/bin/activate  to use the virtualenv')"
